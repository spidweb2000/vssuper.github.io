"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7433],{7433:(B,g,c)=>{c.r(g),c.d(g,{CustomerDataPageModule:()=>y});var d=c(177),m=c(4341),u=c(4742),h=c(8986),D=c(467),t=c(4438),f=c(1626),F=c(671);function C(e,r){1&e&&t.nrm(0,"ion-icon",13),2&e&&t.Y8G("routerLink","/login")}function _(e,r){1&e&&(t.j41(0,"th"),t.EFF(1,"\u5458\u5de5"),t.k0s())}function j(e,r){if(1&e&&(t.j41(0,"td"),t.EFF(1),t.k0s()),2&e){const i=t.XpG().$implicit;t.R7$(),t.JRh(i.access)}}function v(e,r){if(1&e){const i=t.RV6();t.j41(0,"tr"),t.DNE(1,j,2,1,"td",14),t.j41(2,"td"),t.EFF(3),t.k0s(),t.j41(4,"td"),t.nrm(5,"img",17),t.k0s(),t.j41(6,"td"),t.nrm(7,"video",18),t.k0s(),t.j41(8,"td")(9,"a",19),t.EFF(10,"Open PDF"),t.k0s()(),t.j41(11,"td")(12,"a",19),t.EFF(13,"Open Word Document"),t.k0s()(),t.j41(14,"td",15)(15,"ion-button",20),t.bIt("click",function(){const s=t.eBV(i).$implicit,a=t.XpG(2);return t.Njj(a.confirmDelete(s.id))}),t.EFF(16," \u5220\u9664 "),t.k0s()()()}if(2&e){const i=r.$implicit,o=t.XpG(2);t.R7$(),t.Y8G("ngIf",o.isAdmin),t.R7$(2),t.JRh(i.name),t.R7$(2),t.Mz_("alt","",i.name,"'s photo"),t.Y8G("src","assets/"+i.photo,t.B4B),t.R7$(2),t.Y8G("src","assets/"+i.video,t.B4B),t.R7$(2),t.Y8G("href","assets/"+i.pdf,t.B4B),t.R7$(3),t.Y8G("href","assets/"+i.word,t.B4B)}}function b(e,r){if(1&e&&(t.j41(0,"table")(1,"tr"),t.DNE(2,_,2,0,"th",14),t.j41(3,"th"),t.EFF(4,"\u540d\u5b57"),t.k0s(),t.j41(5,"th"),t.EFF(6,"\u7167\u7247"),t.k0s(),t.j41(7,"th"),t.EFF(8,"\u89c6\u9891"),t.k0s(),t.j41(9,"th"),t.EFF(10,"PDF"),t.k0s(),t.j41(11,"th"),t.EFF(12,"Word"),t.k0s(),t.nrm(13,"th",15),t.k0s(),t.DNE(14,v,17,8,"tr",16),t.k0s()),2&e){const i=t.XpG();t.R7$(2),t.Y8G("ngIf",i.isAdmin),t.R7$(12),t.Y8G("ngForOf",i.customersData)}}function P(e,r){1&e&&(t.j41(0,"p"),t.EFF(1,"\u6ca1\u6709\u987e\u5ba2\u8d44\u6599"),t.k0s())}const E=[{path:"",component:(()=>{var e;class r{constructor(o,s,a){this.http=o,this.authService=s,this.alertController=a,this.customersData=[],this.userAccess="",this.isAdmin=!1,this.isLoggedIn=!0,this.customer={name:"",photo:null,video:null,pdf:null,word:null,access:""}}ngOnInit(){this.authService.access$.subscribe(o=>{this.userAccess=o}),this.authService.sharedData$.subscribe(o=>{this.isAdmin=o}),!this.isAdmin&&""==this.userAccess&&(this.isLoggedIn=!1),this.displayData()}chooseFile(o,s){const a=s.target.files[0];a&&(this.customer[o]={fileName:a.name,filePath:a})}submitForm(){var o,s,a,l;const n=new FormData;n.append("name",this.customer.name||""),n.append("photo",(null===(o=this.customer.photo)||void 0===o?void 0:o.filePath)||""),n.append("video",(null===(s=this.customer.video)||void 0===s?void 0:s.filePath)||""),n.append("pdf",(null===(a=this.customer.pdf)||void 0===a?void 0:a.filePath)||""),n.append("word",(null===(l=this.customer.word)||void 0===l?void 0:l.filePath)||""),n.append("access",this.isAdmin?"admin":this.userAccess),this.http.post("http://localhost:3000/api/insertcustomer",n).subscribe(p=>{console.log("Data submitted successfully",p),this.authService.prompt("\u63d0\u4ea4\u6210\u529f"),this.clear(),this.displayData()},p=>{console.error("Error submitting data",p),this.authService.prompt("\u63d0\u4ea4\u5931\u8d25")})}displayData(){this.http.get("http://localhost:3000/api/customers-data").subscribe(o=>{this.customersData=this.isAdmin?o:o.filter(s=>s.access==this.userAccess),console.log(this.customersData),this.customersData.forEach(s=>{})},o=>{console.error("Error fetching customer data:",o)})}confirmDelete(o){var s=this;return(0,D.A)(function*(){yield(yield s.alertController.create({message:"\u786e\u8ba4\u8981\u5220\u9664\u5417\uff1f",buttons:[{text:"\u53d6\u6d88",role:"cancel"},{text:"\u786e\u5b9a",handler:()=>{s.deleteCustomer(o)}}]})).present()})()}deleteCustomer(o){this.authService.deleteCustomer(o).subscribe(s=>{console.log("User deleted:",s),this.customersData=this.customersData.filter(a=>a.id!==o)},s=>{console.error("Error deleting user:",s)})}clear(){this.customer.name="",this.customer.photo=null,this.customer.video=null,this.customer.pdf=null,this.customer.word=null}}return(e=r).\u0275fac=function(o){return new(o||e)(t.rXU(f.Qq),t.rXU(F.u),t.rXU(u.hG))},e.\u0275cmp=t.VBU({type:e,selectors:[["app-customer-data"]],decls:32,vars:5,consts:[["noData",""],["color","primary"],["size","large","slot","end","name","person-circle-outline",3,"routerLink",4,"ngIf"],["padding",""],[3,"submit"],["position","floating"],["name","name","required","",3,"ngModelChange","ngModel"],["type","file","name","photo","accept","image/*",3,"change"],["type","file","name","video","accept","video/*",3,"change"],["type","file","name","pdf","accept","application/pdf",3,"change"],["type","file","name","word","accept",".docx,.doc",3,"change"],["expand","full","type","submit",3,"disabled"],[4,"ngIf","ngIfElse"],["size","large","slot","end","name","person-circle-outline",3,"routerLink"],[4,"ngIf"],[1,"button"],[4,"ngFor","ngForOf"],[1,"customer-photo",3,"src","alt"],["controls","","width","100%",3,"src"],["target","_blank",3,"href"],["color","danger",3,"click"]],template:function(o,s){if(1&o){const a=t.RV6();t.j41(0,"ion-header")(1,"ion-toolbar",1)(2,"ion-title"),t.EFF(3,"\u987e\u5ba2\u8d44\u6599"),t.k0s(),t.DNE(4,C,1,1,"ion-icon",2),t.k0s()(),t.j41(5,"ion-content",3)(6,"form",4),t.bIt("submit",function(){return t.eBV(a),t.Njj(s.submitForm())}),t.j41(7,"ion-item")(8,"ion-label",5),t.EFF(9,"\u540d\u5b57"),t.k0s(),t.j41(10,"ion-input",6),t.mxI("ngModelChange",function(n){return t.eBV(a),t.DH7(s.customer.name,n)||(s.customer.name=n),t.Njj(n)}),t.k0s()(),t.j41(11,"ion-item")(12,"ion-label"),t.EFF(13,"\u7167\u7247"),t.k0s(),t.j41(14,"input",7),t.bIt("change",function(n){return t.eBV(a),t.Njj(s.chooseFile("photo",n))}),t.k0s()(),t.j41(15,"ion-item")(16,"ion-label"),t.EFF(17,"\u89c6\u9891"),t.k0s(),t.j41(18,"input",8),t.bIt("change",function(n){return t.eBV(a),t.Njj(s.chooseFile("video",n))}),t.k0s()(),t.j41(19,"ion-item")(20,"ion-label"),t.EFF(21,"PDF"),t.k0s(),t.j41(22,"input",9),t.bIt("change",function(n){return t.eBV(a),t.Njj(s.chooseFile("pdf",n))}),t.k0s()(),t.j41(23,"ion-item")(24,"ion-label"),t.EFF(25,"\u6587\u4ef6"),t.k0s(),t.j41(26,"input",10),t.bIt("change",function(n){return t.eBV(a),t.Njj(s.chooseFile("word",n))}),t.k0s()(),t.j41(27,"ion-button",11),t.EFF(28,"\u63d0\u4ea4"),t.k0s()(),t.DNE(29,b,15,2,"table",12)(30,P,2,0,"ng-template",null,0,t.C5r),t.k0s()}if(2&o){const a=t.sdS(31);t.R7$(4),t.Y8G("ngIf",!s.isLoggedIn),t.R7$(6),t.R50("ngModel",s.customer.name),t.R7$(17),t.Y8G("disabled",!s.customer.name),t.R7$(2),t.Y8G("ngIf",s.customersData.length>0)("ngIfElse",a)}},dependencies:[d.Sq,d.bT,m.qT,m.BC,m.cb,m.YS,m.vS,m.cV,u.Jm,u.W9,u.eU,u.iq,u.$w,u.uz,u.he,u.BC,u.ai,u.Gw,u.N7,h.Wk],styles:["table[_ngcontent-%COMP%]{width:96%;border-collapse:collapse;margin:20px 25px}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{border:1px solid #ddd;padding:8px;text-align:left}th[_ngcontent-%COMP%]{background-color:var(--ion-color-light-contrast);opacity:.5;color:var(--ion-color-primary-contrast, #fff)}img[_ngcontent-%COMP%]{max-width:100%;height:auto}video[_ngcontent-%COMP%]{max-width:100%}.customer-photo[_ngcontent-%COMP%]{width:100px;height:100px}.button[_ngcontent-%COMP%]{padding-right:0;padding-left:0;text-align:center}"]}),r})()}];let k=(()=>{var e;class r{}return(e=r).\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.$C({type:e}),e.\u0275inj=t.G2t({imports:[h.iI.forChild(E),h.iI]}),r})();var $=c(4985),M=c(8817);let y=(()=>{var e;class r{}return(e=r).\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.$C({type:e}),e.\u0275inj=t.G2t({providers:[$.K,M.Z],imports:[d.MD,m.YN,u.bv,k,f.q1]}),r})()}}]);