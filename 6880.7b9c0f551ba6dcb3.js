"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6880],{6880:(B,l,a)=>{a.r(l),a.d(l,{TurnoverPageModule:()=>P});var F=a(177),j=a(4341),r=a(4742),c=a(8986),d=a(2288),t=a(4438),E=a(1626),R=a(671);function f(n,i){1&n&&t.nrm(0,"ion-icon",7),2&n&&t.Y8G("routerLink","/login")}function m(n,i){if(1&n){const e=t.RV6();t.j41(0,"ion-button",8),t.bIt("click",function(){t.eBV(e);const u=t.XpG();return t.Njj(u.importExcel())}),t.EFF(1," \u5bfc\u5165Excel "),t.k0s()}}function v(n,i){1&n&&(t.j41(0,"th"),t.EFF(1,"\u5458\u5de5"),t.k0s())}function $(n,i){if(1&n&&(t.j41(0,"td"),t.EFF(1),t.k0s()),2&n){const e=t.XpG().$implicit;t.R7$(),t.JRh(e.access)}}function D(n,i){if(1&n&&(t.j41(0,"tr"),t.DNE(1,$,2,1,"td",5),t.j41(2,"td"),t.EFF(3),t.k0s(),t.j41(4,"td"),t.EFF(5),t.k0s(),t.j41(6,"td"),t.EFF(7),t.k0s(),t.j41(8,"td"),t.EFF(9),t.k0s(),t.j41(10,"td"),t.EFF(11),t.k0s(),t.j41(12,"td"),t.EFF(13),t.k0s(),t.j41(14,"td"),t.EFF(15),t.k0s(),t.j41(16,"td"),t.EFF(17),t.k0s(),t.j41(18,"td"),t.EFF(19),t.k0s(),t.j41(20,"td"),t.EFF(21),t.k0s(),t.j41(22,"td"),t.EFF(23),t.k0s(),t.j41(24,"td"),t.EFF(25),t.k0s(),t.j41(26,"td"),t.EFF(27),t.k0s(),t.j41(28,"td"),t.EFF(29),t.k0s(),t.j41(30,"td"),t.EFF(31),t.k0s(),t.j41(32,"td"),t.EFF(33),t.k0s(),t.j41(34,"td"),t.EFF(35),t.k0s(),t.j41(36,"td"),t.EFF(37),t.k0s(),t.j41(38,"td"),t.EFF(39),t.k0s(),t.j41(40,"td"),t.EFF(41),t.k0s(),t.j41(42,"td"),t.EFF(43),t.k0s(),t.j41(44,"td"),t.EFF(45),t.k0s(),t.j41(46,"td"),t.EFF(47),t.k0s(),t.j41(48,"td"),t.EFF(49),t.k0s(),t.j41(50,"td"),t.EFF(51),t.k0s()()),2&n){const e=i.$implicit,s=t.XpG();t.R7$(),t.Y8G("ngIf",s.isAdmin),t.R7$(2),t.JRh(e.id),t.R7$(2),t.JRh(e.new),t.R7$(2),t.JRh(e.outDate),t.R7$(2),t.JRh(e.name),t.R7$(2),t.JRh(e.nickName),t.R7$(2),t.JRh(e.ic),t.R7$(2),t.JRh(e.phone),t.R7$(2),t.JRh(e.income),t.R7$(2),t.JRh(e.occupation),t.R7$(2),t.JRh(e.pic),t.R7$(2),t.JRh(e.divide),t.R7$(2),t.JRh(e.source),t.R7$(2),t.JRh(e.account),t.R7$(2),t.JRh(e.owe),t.R7$(2),t.JRh(e.take),t.R7$(2),t.JRh(e.ins),t.R7$(2),t.JRh(e.fees),t.R7$(2),t.JRh(e.open),t.R7$(2),t.JRh(e.deposit),t.R7$(2),t.JRh(e.pay),t.R7$(2),t.JRh(e.dueDate),t.R7$(2),t.JRh(e.dueTime),t.R7$(2),t.JRh(e.duration),t.R7$(2),t.JRh(e.keep),t.R7$(2),t.JRh(e.note)}}const T=[{path:"",component:(()=>{var n;class i{constructor(s,u,h){this.router=s,this.http=u,this.authService=h,this.outs=[],this.userAccess="",this.isAdmin=!1,this.isLoggedIn=!0}ngOnInit(){this.loadOutData(),this.authService.access$.subscribe(s=>{this.userAccess=s}),this.authService.sharedData$.subscribe(s=>{this.isAdmin=s}),!this.isAdmin&&""==this.userAccess&&(this.isLoggedIn=!1)}loadOutData(){this.http.get("http://localhost:3000/api/outData").subscribe(s=>{this.outs=this.isAdmin?s:s.filter(u=>u.access==this.userAccess)},s=>{console.error("Error fetching customer data",s)})}importExcel(){const s=document.createElement("input");s.type="file",s.accept=".xlsx, .xls",s.onchange=u=>{const h=u.target.files[0],p=new FileReader;p.onload=A=>{const y=new Uint8Array(A.target.result),k=d.LF(y,{type:"array"}),g=d.Wp.sheet_to_json(k.Sheets[k.SheetNames[0]],{header:1});g.shift();const x=g.map(o=>({access:o[0]||"",id:o[1]||"",new:o[2]||"",outDate:o[3]||"",name:o[4]||"",nickName:o[5]||"",ic:o[6]||"",phone:o[7]||"",income:o[8]||"",occupation:o[9]||"",pic:o[10]||"",divide:o[11]||"",source:o[12]||"",account:o[13]||"",owe:o[14]||"",take:o[15]||"",ins:o[16]||"",fees:o[17]||"",open:o[18]||"",deposit:o[19]||"",pay:o[20]||"",dueDate:o[21]||"",dueTime:o[22]||"",duration:o[23]||"",keep:o[24]||"",note:o[25]||""})).filter(o=>o.access&&o.id);this.uploadOutData(x)},p.readAsArrayBuffer(h)},s.click()}uploadOutData(s){this.http.post("http://localhost:3000/api/import-outs",s).subscribe(u=>{console.log("Out Data imported successfully",u),this.loadOutData()},u=>{console.error("Error importing out data",u)})}}return(n=i).\u0275fac=function(s){return new(s||n)(t.rXU(c.Ix),t.rXU(E.Qq),t.rXU(R.u))},n.\u0275cmp=t.VBU({type:n,selectors:[["app-turnover"]],decls:64,vars:4,consts:[["color","primary"],["size","large","slot","end","name","person-circle-outline",3,"routerLink",4,"ngIf"],[1,"ion-padding"],["expand","full","color","secondary",3,"click",4,"ngIf"],[1,"table-container"],[4,"ngIf"],[4,"ngFor","ngForOf"],["size","large","slot","end","name","person-circle-outline",3,"routerLink"],["expand","full","color","secondary",3,"click"]],template:function(s,u){1&s&&(t.j41(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-title"),t.EFF(3,"\u51fa\u8d26"),t.k0s(),t.DNE(4,f,1,1,"ion-icon",1),t.k0s()(),t.j41(5,"ion-content",2),t.DNE(6,m,2,0,"ion-button",3),t.j41(7,"div",4)(8,"table")(9,"thead")(10,"tr"),t.DNE(11,v,2,0,"th",5),t.j41(12,"th"),t.EFF(13,"\u7f16\u53f7"),t.k0s(),t.j41(14,"th"),t.EFF(15,"\u65b0/\u65e7"),t.k0s(),t.j41(16,"th"),t.EFF(17,"\u51fa\u8d26\u65e5\u671f"),t.k0s(),t.j41(18,"th"),t.EFF(19,"\u987e\u5ba2\u540d\u5b57"),t.k0s(),t.j41(20,"th"),t.EFF(21,"\u987e\u5ba2\u82b1\u540d"),t.k0s(),t.j41(22,"th"),t.EFF(23,"IC\u53f7\u7801"),t.k0s(),t.j41(24,"th"),t.EFF(25,"\u7535\u8bdd\u53f7\u7801"),t.k0s(),t.j41(26,"th"),t.EFF(27,"\u6536\u5165"),t.k0s(),t.j41(28,"th"),t.EFF(29,"\u804c\u4e1a"),t.k0s(),t.j41(30,"th"),t.EFF(31,"\u51fa\u8d26\u4eba"),t.k0s(),t.j41(32,"th"),t.EFF(33,"\u9664"),t.k0s(),t.j41(34,"th"),t.EFF(35,"\u987e\u5ba2\u6765\u6e90"),t.k0s(),t.j41(36,"th"),t.EFF(37,"\u987e\u5ba2\u6237\u53e3"),t.k0s(),t.j41(38,"th"),t.EFF(39,"\u501f"),t.k0s(),t.j41(40,"th"),t.EFF(41,"\u62ff"),t.k0s(),t.j41(42,"th"),t.EFF(43,"\u5229\u606f"),t.k0s(),t.j41(44,"th"),t.EFF(45,"\u624b\u7eed\u8d39"),t.k0s(),t.j41(46,"th"),t.EFF(47,"\u5f00\u6237\u53e3"),t.k0s(),t.j41(48,"th"),t.EFF(49,"\u62b5\u62bc"),t.k0s(),t.j41(50,"th"),t.EFF(51,"\u8fd8"),t.k0s(),t.j41(52,"th"),t.EFF(53,"\u5230\u671f"),t.k0s(),t.j41(54,"th"),t.EFF(55,"\u65f6\u95f4"),t.k0s(),t.j41(56,"th"),t.EFF(57,"\u5929\u6570"),t.k0s(),t.j41(58,"th"),t.EFF(59,"\u6536\u8d26\u6237\u53e3"),t.k0s(),t.j41(60,"th"),t.EFF(61,"\u5907\u6ce8"),t.k0s()()(),t.j41(62,"tbody"),t.DNE(63,D,52,26,"tr",6),t.k0s()()()()),2&s&&(t.R7$(4),t.Y8G("ngIf",!u.isLoggedIn),t.R7$(2),t.Y8G("ngIf",u.isAdmin),t.R7$(5),t.Y8G("ngIf",u.isAdmin),t.R7$(52),t.Y8G("ngForOf",u.outs))},dependencies:[F.Sq,F.bT,r.Jm,r.W9,r.eU,r.iq,r.BC,r.ai,r.N7,c.Wk],styles:[".table-container[_ngcontent-%COMP%]{width:100%;overflow-x:auto;-webkit-overflow-scrolling:touch}table[_ngcontent-%COMP%]{width:96%;border-collapse:collapse;margin:20px 25px}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{border:1px solid #ddd;padding:8px;text-align:left}th[_ngcontent-%COMP%]{background-color:var(--ion-color-light-contrast);opacity:.5;color:var(--ion-color-primary-contrast, #fff)}"]}),i})()}];let J=(()=>{var n;class i{}return(n=i).\u0275fac=function(s){return new(s||n)},n.\u0275mod=t.$C({type:n}),n.\u0275inj=t.G2t({imports:[c.iI.forChild(T),c.iI]}),i})(),P=(()=>{var n;class i{}return(n=i).\u0275fac=function(s){return new(s||n)},n.\u0275mod=t.$C({type:n}),n.\u0275inj=t.G2t({imports:[F.MD,j.YN,r.bv,J,E.q1]}),i})()}}]);