"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[988],{988:(M,d,r)=>{r.r(d),r.d(d,{ProfitPageModule:()=>I});var u=r(177),E=r(4341),c=r(4742),l=r(8986),f=r(2288),t=r(4438),F=r(1626),P=r(671);function k(e,a){1&e&&t.nrm(0,"ion-icon",7),2&e&&t.Y8G("routerLink","/login")}function j(e,a){if(1&e){const i=t.RV6();t.j41(0,"ion-button",8),t.bIt("click",function(){t.eBV(i);const s=t.XpG();return t.Njj(s.importExcel())}),t.EFF(1," \u5bfc\u5165Excel "),t.k0s()}}function R(e,a){1&e&&(t.j41(0,"th"),t.EFF(1,"\u5458\u5de5"),t.k0s())}function D(e,a){if(1&e&&(t.j41(0,"td"),t.EFF(1),t.k0s()),2&e){const i=t.XpG().$implicit;t.R7$(),t.JRh(i.access)}}function $(e,a){if(1&e&&(t.j41(0,"tr"),t.DNE(1,D,2,1,"td",5),t.j41(2,"td"),t.EFF(3),t.k0s(),t.j41(4,"td"),t.EFF(5),t.k0s(),t.j41(6,"td"),t.EFF(7),t.k0s(),t.j41(8,"td"),t.EFF(9),t.k0s(),t.j41(10,"td"),t.EFF(11),t.k0s(),t.j41(12,"td"),t.EFF(13),t.k0s(),t.j41(14,"td"),t.EFF(15),t.k0s(),t.j41(16,"td"),t.EFF(17),t.k0s(),t.j41(18,"td"),t.EFF(19),t.k0s(),t.j41(20,"td"),t.EFF(21),t.k0s(),t.j41(22,"td"),t.EFF(23),t.k0s(),t.j41(24,"td"),t.EFF(25),t.k0s(),t.j41(26,"td"),t.EFF(27),t.k0s(),t.j41(28,"td"),t.EFF(29),t.k0s()()),2&e){const i=a.$implicit,n=t.XpG();t.R7$(),t.Y8G("ngIf",n.isAdmin),t.R7$(2),t.JRh(i.id),t.R7$(2),t.JRh(i.inDate),t.R7$(2),t.JRh(i.name),t.R7$(2),t.JRh(i.ins),t.R7$(2),t.JRh(i.payment),t.R7$(2),t.JRh(i.fees),t.R7$(2),t.JRh(i.income),t.R7$(2),t.JRh(i.receive),t.R7$(2),t.JRh(i.kanzhang),t.R7$(2),t.JRh(i.clear),t.R7$(2),t.JRh(i.total),t.R7$(2),t.JRh(i.account),t.R7$(2),t.JRh(i.next),t.R7$(2),t.JRh(i.note)}}const v=[{path:"",component:(()=>{var e;class a{constructor(n,s,h){this.router=n,this.http=s,this.authService=h,this.ins=[],this.userAccess="",this.isAdmin=!1,this.isLoggedIn=!0}ngOnInit(){this.loadInData(),this.authService.access$.subscribe(n=>{this.userAccess=n}),this.authService.sharedData$.subscribe(n=>{this.isAdmin=n}),!this.isAdmin&&""==this.userAccess&&(this.isLoggedIn=!1)}loadInData(){this.http.get("http://localhost:3000/api/inData").subscribe(n=>{this.ins=this.isAdmin?n:n.filter(s=>s.access==this.userAccess)},n=>{console.error("Error fetching customer data",n)})}importExcel(){const n=document.createElement("input");n.type="file",n.accept=".xlsx, .xls",n.onchange=s=>{const h=s.target.files[0],g=new FileReader;g.onload=x=>{const b=new Uint8Array(x.target.result),p=f.LF(b,{type:"array"}),m=f.Wp.sheet_to_json(p.Sheets[p.SheetNames[0]],{header:1});m.shift();const A=m.map(o=>({access:o[0]||"",id:o[26]||"",inDate:o[27]||"",name:o[4]||"",ins:o[28]||"",payment:o[29]||"",fees:o[30]||"",income:o[31]||"",receive:o[32]||"",kanzhang:o[33]||"",clear:o[34]||"",total:o[35]||"",account:o[36]||"",next:o[37]||"",note:o[38]||""})).filter(o=>o.access&&o.id);this.uploadInData(A)},g.readAsArrayBuffer(h)},n.click()}uploadInData(n){this.http.post("http://localhost:3000/api/import-ins",n).subscribe(s=>{console.log("In Data imported successfully",s),this.loadInData()},s=>{console.error("Error importing in data",s)})}}return(e=a).\u0275fac=function(n){return new(n||e)(t.rXU(l.Ix),t.rXU(F.Qq),t.rXU(P.u))},e.\u0275cmp=t.VBU({type:e,selectors:[["app-profit"]],decls:42,vars:4,consts:[["color","primary"],["size","large","slot","end","name","person-circle-outline",3,"routerLink",4,"ngIf"],[1,"ion-padding"],["expand","full","color","secondary",3,"click",4,"ngIf"],[1,"table-container"],[4,"ngIf"],[4,"ngFor","ngForOf"],["size","large","slot","end","name","person-circle-outline",3,"routerLink"],["expand","full","color","secondary",3,"click"]],template:function(n,s){1&n&&(t.j41(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-title"),t.EFF(3,"\u6536\u8d26"),t.k0s(),t.DNE(4,k,1,1,"ion-icon",1),t.k0s()(),t.j41(5,"ion-content",2),t.DNE(6,j,2,0,"ion-button",3),t.j41(7,"div",4)(8,"table")(9,"thead")(10,"tr"),t.DNE(11,R,2,0,"th",5),t.j41(12,"th"),t.EFF(13,"\u7f16\u53f7"),t.k0s(),t.j41(14,"th"),t.EFF(15,"\u6536\u8d26\u65e5\u671f"),t.k0s(),t.j41(16,"th"),t.EFF(17,"\u987e\u5ba2\u540d\u5b57"),t.k0s(),t.j41(18,"th"),t.EFF(19,"\u6536\u5229\u606f"),t.k0s(),t.j41(20,"th"),t.EFF(21,"Payment"),t.k0s(),t.j41(22,"th"),t.EFF(23,"\u8865"),t.k0s(),t.j41(24,"th"),t.EFF(25,"\u6765\u94b1"),t.k0s(),t.j41(26,"th"),t.EFF(27,"\u914d\u5408\u6536"),t.k0s(),t.j41(28,"th"),t.EFF(29,"\u780d\u8d26"),t.k0s(),t.j41(30,"th"),t.EFF(31,"\u6e05\u8d26"),t.k0s(),t.j41(32,"th"),t.EFF(33,"\u603b\u6570"),t.k0s(),t.j41(34,"th"),t.EFF(35,"\u6536\u8d26\u6237\u53e3"),t.k0s(),t.j41(36,"th"),t.EFF(37,"\u4e0b\u4e00\u671f"),t.k0s(),t.j41(38,"th"),t.EFF(39,"\u5907\u6ce8"),t.k0s()()(),t.j41(40,"tbody"),t.DNE(41,$,30,15,"tr",6),t.k0s()()()()),2&n&&(t.R7$(4),t.Y8G("ngIf",!s.isLoggedIn),t.R7$(2),t.Y8G("ngIf",s.isAdmin),t.R7$(5),t.Y8G("ngIf",s.isAdmin),t.R7$(30),t.Y8G("ngForOf",s.ins))},dependencies:[u.Sq,u.bT,c.Jm,c.W9,c.eU,c.iq,c.BC,c.ai,c.N7,l.Wk],styles:[".table-container[_ngcontent-%COMP%]{width:100%;overflow-x:auto;-webkit-overflow-scrolling:touch}table[_ngcontent-%COMP%]{width:96%;border-collapse:collapse;margin:20px 25px}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{border:1px solid #ddd;padding:8px;text-align:left}th[_ngcontent-%COMP%]{background-color:var(--ion-color-light-contrast);opacity:.5;color:var(--ion-color-primary-contrast, #fff)}"]}),a})()}];let y=(()=>{var e;class a{}return(e=a).\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.$C({type:e}),e.\u0275inj=t.G2t({imports:[l.iI.forChild(v),l.iI]}),a})(),I=(()=>{var e;class a{}return(e=a).\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.$C({type:e}),e.\u0275inj=t.G2t({imports:[u.MD,E.YN,c.bv,y,F.q1]}),a})()}}]);